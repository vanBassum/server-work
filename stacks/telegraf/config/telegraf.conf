[agent]
  interval = "1s"
  round_interval = true

# --- INPUTS: MQTT ---
[[inputs.mqtt_consumer]]
  servers = ["tcp://mosquitto:1883"]

  # Subscribe to all topics from all devices
  topics = ["+/+/+#"]

  # Payload is a single number (float)
  data_format = "value"
  data_type = "float"

  # Include original topic for reference
  topic_tag = "topic"

  # Parse out SID, IST, DEVID, and the rest of the path
  # Example:
  # KC1245/000001/01/thermostat/setpoint
  # => sid=KC1245, ist=000001, devid=01, path=thermostat/setpoint
  topic_parsing = "topic"
  topic_parsing_pattern = "(?P<sid>[^/]+)/(?P<ist>[^/]+)/(?P<devid>[^/]+)/(?P<path>.*)"
  topic_parsing_tags = ["sid", "ist", "devid", "path"]

# --- OUTPUTS: InfluxDB ---
[[outputs.influxdb_v2]]
  urls = ["http://influxdb:8086"]
  token = "W_NKxV9K4ckLaAkwAZFMT0IxOtDZGddL-L6hI2BjZBbNPnlpfzOQiTzKOzSmABn4L0Bs7DnP1g=="
  organization = "d3bbb5ed293585c3"
  bucket = "mqtt"
